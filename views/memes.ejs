<!DOCTYPE html>
<html lang="en">

<head>
  <title>Portfolio</title>
  <link rel="stylesheet" href="../../css/bootstrap.min.css" />
  <link href="../../stylesheets/navbar.css" rel="stylesheet">
</head>

<body class="position-relative" data-bs-spy="scroll">
  <%- include('./partials/navbar.ejs') %>
    <section class="container">
      <table class="table" id="table">
        <thead>
          <tr>
            <th scope="col">ID</th>
            <th scope="col">Size</th>
            <th scope="col">Image</th>
            <th scope="col">Options</th>
          </tr>
        </thead>
        <tbody>
          <% memes.forEach((meme) => { %>
            <tr class="<%= viewedMemes.includes(meme.id) ? 'table-success' : '' %>">
              <th scope="row"><%= meme.id %></th>
              <td><%= meme.width %>x<%= meme.height %></td>
              <td>
                <img src="<%= meme.url %>" alt="<%= meme.name %>" style="width: 20%;">
              </td>
              <td>
                <button class="btn btn-primary view-detail" data-id="<%= meme.id %>">Details</button>
              </td>
            </tr>
          <% }); %>
        </tbody>
        
      </table>
    </section>
    <script>
      // JavaScript to handle row highlighting
      document.querySelectorAll('.view-detail').forEach(button => {
        button.addEventListener('click', function() {
          const memeId = this.getAttribute('data-id');

          // Add the meme ID to cookies for server-side persistence
          document.cookie = `viewedMemes=${memeId}; path=/;`;
        });
      });

      // Highlight rows for viewed memes on page load
      const viewedMemes = document.cookie
        .split('; ')
        .find(row => row.startsWith('viewedMemes='))
        ?.split('=')[1]
        ?.split(',') || [];

      document.querySelectorAll('tr').forEach(row => {
        const button = row.querySelector('.view-detail');
        if (button) {
          const memeId = button.getAttribute('data-id');
          if (viewedMemes.includes(memeId)) {
            row.classList.add('table-success');
          }
        }
      });
    </script>
    <%- include('./partials/scripts.ejs') %>
</body>

</html>
